<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Diallel cross of Aztec tobacco — hayman.tobacco • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Diallel cross of Aztec tobacco — hayman.tobacco" />

<meta property="og:description" content="Diallel cross of Aztec tobacco in 2 reps" />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_papadakis.html">Using Papadakis covariates for nearest neighbor analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diallel cross of Aztec tobacco</h1>
    
    <div class="hidden name"><code>hayman.tobacco.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Diallel cross of Aztec tobacco in 2 reps</p>
    
    </div>

        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    

<p></p><dl class='dl-horizontal'>
    <dt><code>year</code></dt><dd><p>year</p></dd>
    <dt><code>block</code></dt><dd><p>block factor, 2 levels</p></dd>
    <dt><code>male</code></dt><dd><p>male parent, 8 levels</p></dd>
    <dt><code>female</code></dt><dd><p>female parent</p></dd>
    <dt><code>day</code></dt><dd><p>mean flowering time (days)</p></dd>
  </dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
  
<p>Data was collected in 1951 (Hayman 1954a) and 1952 (Hayman 1954b).</p>
<p>In each year there were 8 varieties of Aztec tobacco, <em>Nicotiana rustica L.</em>.</p>
<p>Each cross/self was represented by 10 progeny, in two plots of 5
  plants each.  The data are the mean flowering time per plot.</p>
<p>Note, the 1951 data as published in Hayman (1954a) Table 5 contain
  "10 times the mean flowering time".  The data here have been divided
  by 10 so as to be comparable with the 1952 data.</p>
<p>Hayman (1954b) says "Table 2 lists...three characters from a diallel
  cross of Nicotiana rustica varieties which was repeated for three years."
  This seems to indicate that the varieties are the same in 1951 and
  1952.  Calculating the GCA effects separately for 1951 and 1952 and
  then comparing these estimates shows that they are highly correlated.</p>
    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    

<p>B. I. Hayman (1954a). The Analysis of Variance of Diallel Tables.
  <em>Biometrics</em>, 10, 235-244.  Table 5, page 241.
  http://doi.org/10.2307/3001877</p>
<p>Hayman, B.I. (1954b). The theory and analysis of diallel crosses.
  <em>Genetics</em>, 39, 789-809.  Table 3, page 805.
  http://www.genetics.org/content/39/6/789.full.pdf</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p># For 1951 data</p>
<p>Mohring, Melchinger, Piepho. (2011).
  REML-Based Diallel Analysis.
  <em>Crop Science</em>, 51, 470-478.</p>
<p># For 1952 data</p>
<p>C. Clark Cockerham and B. S. Weir. (1977).
  Quadratic analyses of reciprocal crosses.
  <em>Biometrics</em> 33, 187-203.  Appendix C.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>agridat</span>)

  <span class='co'># 1951 data.  Fit the first REML model of Mohring 2011 Supplement.</span>

  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>hayman.tobacco</span>)
  <span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>hayman.tobacco</span>, <span class='no'>year</span><span class='kw'>==</span><span class='fl'>1951</span>)

  <span class='co'># Make a factor 'comb' in which G1xG2 is the same cross as G2xG1</span>
  <span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat1</span>, <span class='kw'>comb</span> <span class='kw'>=</span>
                            <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>male</span>) <span class='kw'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>female</span>),
                                   <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>male</span>,<span class='no'>female</span>), <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>female</span>,<span class='no'>male</span>)))
  <span class='co'># 'dr' is the direction of the cross, 0 for self</span>
  <span class='no'>dat1</span>$<span class='no'>dr</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
  <span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat1</span>,
                    <span class='kw'>dr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>male</span>) <span class='kw'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>female</span>), -<span class='fl'>1</span>, <span class='no'>dr</span>))
  <span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat1</span>,
                    <span class='kw'>dr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>male</span>) <span class='kw'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>female</span>), <span class='fl'>0</span>, <span class='no'>dr</span>))

  <span class='co'># ASREML code for Mixed Griffing.</span>
  <span class='co'># Mohring Table 2, column 2 (after dividing by 10^2) gives variances:</span>
  <span class='co'># GCA 12.77, SCA 11.09, RSCA .65, Error 4.23.</span>
  <span class='co'># Mohring Supplement ASREML code part1 model is:</span>
  <span class='co'># y ~ mu r !r mother and(father) combination combination.dr</span>
  <span class='co'># Note that the levels of 'male' and 'female' are the same, so the</span>
  <span class='co'># and(female) term tells asreml to use the same levels (or, equivalently,</span>
  <span class='co'># fix the correlation of the male/female levels to be 1.</span>
  <span class='co'># The block effect is minimial and therefore ignored.</span>
  <span class='co'>## m1 &lt;- asreml(day~1, data=dat1,</span>
  <span class='co'>##              random = ~ male + and(female) + comb + comb:dr)</span>
  <span class='co'>## libs(lucid)</span>
  <span class='co'>## vc(m1)</span>
  <span class='co'>##           effect component std.error z.ratio      con</span>
  <span class='co'>##    male!male.var   12.77      7.502      1.7 Positive</span>
  <span class='co'>##    comb!comb.var   11.11      3.353      3.3 Positive</span>
  <span class='co'>## comb:dr!comb.var    0.6603    0.4926     1.3 Positive</span>
  <span class='co'>##       R!variance    4.185     0.7449     5.6 Positive</span>

  <span class='co'># --------------------</span>

  <span class='co'># 1952 data. Reproduce table 3 and figure 2 of Hayman 1954b.</span>

  <span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>hayman.tobacco</span>, <span class='no'>year</span><span class='kw'>==</span><span class='fl'>1952</span>)

  <span class='co'># Does flowering date follow a gamma distn?  Maybe.</span>
  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>lattice</span>)
  <span class='fu'>densityplot</span>(~<span class='no'>day</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat2</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"hayman.tobacco"</span>,
              <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"flowering date"</span>)</div><div class='img'><img src='hayman.tobacco-1.png' alt='' width='700' height='433' /></div><div class='input'>

  <span class='no'>d1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>dat2</span>, <span class='no'>block</span><span class='kw'>==</span><span class='st'>'B1'</span>)
  <span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>dat2</span>, <span class='no'>block</span><span class='kw'>==</span><span class='st'>'B2'</span>)

  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>reshape2</span>)
  <span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>acast</span>(<span class='no'>d1</span>, <span class='no'>male</span>~<span class='no'>female</span>, <span class='kw'>value.var</span><span class='kw'>=</span><span class='st'>'day'</span>)
  <span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='fu'>acast</span>(<span class='no'>d2</span>, <span class='no'>male</span>~<span class='no'>female</span>, <span class='kw'>value.var</span><span class='kw'>=</span><span class='st'>'day'</span>)

  <span class='no'>mn1</span> <span class='kw'>&lt;-</span> (<span class='no'>m1</span>+<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>m1</span>))/<span class='fl'>2</span>
  <span class='no'>mn2</span> <span class='kw'>&lt;-</span> (<span class='no'>m2</span>+<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>m2</span>))/<span class='fl'>2</span>

  <span class='co'># Variance and covariance of 'rth' offspring</span>
  <span class='no'>vr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mn1</span>, <span class='fl'>1</span>, <span class='no'>var</span>)
  <span class='no'>vr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mn2</span>, <span class='fl'>1</span>, <span class='no'>var</span>)
  <span class='no'>wr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mn1</span>, <span class='fl'>1</span>, <span class='no'>cov</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>mn1</span>))
  <span class='no'>wr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mn2</span>, <span class='fl'>1</span>, <span class='no'>cov</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>mn2</span>))
  <span class='co'># Remove row names to prevent a mild warning</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>mn1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>mn2</span>) <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>
  <span class='no'>summ</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>mn1</span>,<span class='no'>mn2</span>))
  <span class='no'>summ</span>$<span class='no'>block</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'B1'</span>,<span class='st'>'B2'</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>8</span>)
  <span class='no'>summ</span>$<span class='no'>vr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>vr1</span>,<span class='no'>vr2</span>)
  <span class='no'>summ</span>$<span class='no'>wr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>wr1</span>,<span class='no'>wr2</span>)
  <span class='no'>summ</span>$<span class='no'>male</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>8</span>,<span class='fl'>2</span>) <span class='co'># Vr and Wr match Hayman table 3</span>

  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>summ</span>, <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>wr</span>~<span class='no'>vr</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'n'</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"hayman.tobacco"</span>))</div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>summ</span>, <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>vr</span>, <span class='no'>wr</span>, <span class='no'>male</span>)) <span class='co'># Match Hayman figure 2</span></div><div class='input'>  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"gray"</span>)</div><div class='img'><img src='hayman.tobacco-2.png' alt='' width='700' height='433' /></div><div class='input'>  # Hayman notes that 1 and 3 do not lie along the line,
  # so modifies them and re-analyzes.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#source">Source</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


