<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Growth of soybean varieties in 3 years — davidian.soybean • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Growth of soybean varieties in 3 years — davidian.soybean" />
<meta property="og:description" content="Growth of soybean varieties in 3 years" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_intro.html">Introduction to `agridat`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Growth of soybean varieties in 3 years</h1>
    
    <div class="hidden name"><code>davidian.soybean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Growth of soybean varieties in 3 years</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"davidian.soybean"</span>)</pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>A data frame with 412 observations on the following 5 variables.</p><dl'>
    <dt><code>plot</code></dt><dd><p>plot code</p></dd>
    <dt><code>variety</code></dt><dd><p>variety, F or P</p></dd>
    <dt><code>year</code></dt><dd><p>1988-1990</p></dd>
    <dt><code>day</code></dt><dd><p>days after planting</p></dd>
    <dt><code>weight</code></dt><dd><p>weight of soybean leaves</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This experiment compared the growth patterns of two genotypes of soybean
  varieties: F=Forrest (commercial variety) and P=Plant Introduction
  number 416937 (experimental variety).</p>
<p>Data were collected in 3 consecutive years.</p>
<p>At the start of each growing season, 16 plots were seeded (8 for each
  variety). Data were collected approximately weekly. At each timepoint,
  six plants were randomly selected from each plot. The leaves from these
  6 plants were weighed, and average leaf weight per plant was
  reported. (We assume that the data collection is destructive and
  different plants are sampled at each date).</p>
<p>Note: this data is the same as the "nlme::Soybean" data.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Marie Davidian and D. M. Giltinan, (1995).
  <em>Nonlinear Models for Repeated Measurement Data</em>.
  Chapman and Hall, London.</p>
<p>Electronic version retrieved from
  https://www4.stat.ncsu.edu/~davidian/data/soybean.dat</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Pinheiro, J. C. and Bates, D. M. (2000).
  <em>Mixed-Effects Models in S and S-PLUS</em>.
  Springer, New York.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>

  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>agridat</span>)
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>davidian.soybean</span>)
  <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>davidian.soybean</span>
  <span class='no'>dat</span>$<span class='no'>year</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>dat</span>$<span class='no'>year</span>)

  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>lattice</span>)
  <span class='fu'>xyplot</span>(<span class='no'>weight</span> ~ <span class='no'>day</span><span class='kw'>|</span><span class='no'>variety</span>*<span class='no'>year</span>, <span class='no'>dat</span>,
         <span class='kw'>group</span><span class='kw'>=</span><span class='no'>plot</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>,
         <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"davidian.soybean"</span>)</div><div class='img'><img src='davidian.soybean-1.png' alt='' width='700' height='433' /></div><div class='input'>

  <span class='co'># The only way to keep your sanity with nlme is to use groupedData objects</span>
  <span class='co'># Well, maybe not.  When I use "devtools::run_examples",</span>
  <span class='co'># the "groupedData" function creates a dataframe with/within(?) an</span>
  <span class='co'># environment, and then "nlsList" cannot find datg, even though</span>
  <span class='co'># ls() shows datg is visible and head(datg) is fine.</span>
  <span class='co'># Also works fine in interactive mode. It is driving me insane.</span>
  <span class='co'># reid.grasses has the same problem</span>
  <span class='co'># Use if(0){} to block this code from running.</span>
  <span class='kw'>if</span>(<span class='fl'>0</span>){
    <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>nlme</span>)
    <span class='no'>datg</span> <span class='kw'>&lt;-</span> <span class='fu'>groupedData</span>(<span class='no'>weight</span> ~ <span class='no'>day</span><span class='kw'>|</span><span class='no'>plot</span>, <span class='no'>dat</span>)
    <span class='co'># separate fixed-effect model for each plot</span>
    <span class='co'># 1988P6 gives unusual estimates</span>
    <span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>nlsList</span>(<span class='no'>SSlogis</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>datg</span>,
                  <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>plot</span> <span class='kw'>!=</span> <span class='st'>"1988P6"</span>)
    <span class='co'># plot(m1) # seems heterogeneous</span>
    <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'>intervals</span>(<span class='no'>m1</span>), <span class='kw'>layout</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>1</span>)) <span class='co'># clear year,variety effects in Asym</span>

    <span class='co'># A = maximum, B = time of half A = steepness of curve</span>
    <span class='co'># C = sharpness of curve (smaller = sharper curve)</span>

    <span class='co'># switch to mixed effects</span>
    <span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='fu'>nlme</span>(<span class='no'>weight</span> ~ <span class='no'>A</span> / (<span class='fl'>1</span>+<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>day</span>-<span class='no'>B</span>)/<span class='no'>C</span>)),
               <span class='kw'>data</span><span class='kw'>=</span><span class='no'>datg</span>,
               <span class='kw'>fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>A</span> ~ <span class='fl'>1</span>, <span class='no'>B</span> ~ <span class='fl'>1</span>, <span class='no'>C</span> ~ <span class='fl'>1</span>),
               <span class='kw'>random</span> <span class='kw'>=</span> <span class='no'>A</span> +<span class='no'>B</span> +<span class='no'>C</span> ~ <span class='fl'>1</span>,
               <span class='kw'>start</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>17</span>,<span class='fl'>52</span>,<span class='fl'>7.5</span>))) <span class='co'># no list!</span>

    <span class='co'># add covariates for A,B,C effects, correlation, weights</span>
    <span class='co'># not necessarily best model, but it shows the syntax</span>
    <span class='no'>m3</span> <span class='kw'>&lt;-</span> <span class='fu'>nlme</span>(<span class='no'>weight</span> ~ <span class='no'>A</span> / (<span class='fl'>1</span>+<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>day</span>-<span class='no'>B</span>)/<span class='no'>C</span>)),
               <span class='kw'>data</span><span class='kw'>=</span><span class='no'>datg</span>,
               <span class='kw'>fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>A</span> ~ <span class='no'>variety</span> + <span class='no'>year</span>,
                          <span class='no'>B</span> ~ <span class='no'>year</span>,
                        <span class='no'>C</span> ~ <span class='no'>year</span>),
               <span class='kw'>random</span> <span class='kw'>=</span> <span class='no'>A</span> +<span class='no'>B</span> +<span class='no'>C</span> ~ <span class='fl'>1</span>,
               <span class='kw'>start</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fixed</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>19</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                                   <span class='fl'>55</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                                   <span class='fl'>8</span>,<span class='fl'>0</span>,<span class='fl'>0</span>)),
               <span class='kw'>correlation</span> <span class='kw'>=</span> <span class='fu'>corAR1</span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='fl'>1</span><span class='kw'>|</span><span class='no'>plot</span>),
               <span class='kw'>weights</span><span class='kw'>=</span><span class='fu'>varPower</span>(), <span class='co'># really helps</span>
               <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>mxMaxIter</span><span class='kw'>=</span><span class='fl'>200</span>))

    <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'>augPred</span>(<span class='no'>m3</span>), <span class='kw'>layout</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>8</span>,<span class='fl'>6</span>),
      <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"davidian.soybean - model 3"</span>)
  } <span class='co'># end if(0)</span>
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


