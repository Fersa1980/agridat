<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multi-environment trial of lupin, multiple varieties and densities — verbyla.lupin • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Multi-environment trial of lupin, multiple varieties and densities — verbyla.lupin" />

<meta property="og:description" content="Yield of 9 varieties of lupin at different planting densities across
  2 years and multiple locations." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_papadakis.html">Using Papadakis covariates for nearest neighbor analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-environment trial of lupin, multiple varieties and densities</h1>
    
    <div class="hidden name"><code>verbyla.lupin.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Yield of 9 varieties of lupin at different planting densities across
  2 years and multiple locations.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p></p><dl class='dl-horizontal'>
    <dt><code>gen</code></dt><dd><p>genotype, 9 varieties</p></dd>
    <dt><code>site</code></dt><dd><p>site, 11 levels</p></dd>
    <dt><code>rep</code></dt><dd><p>rep, 2-3 levels</p></dd>
    <dt><code>rate</code></dt><dd><p>seeding rate in plants/m^2</p></dd>
    <dt><code>row</code></dt><dd><p>row</p></dd>
    <dt><code>col</code></dt><dd><p>column</p></dd>
    <dt><code>serp</code></dt><dd><p>factor of 4 levels for serpentine seeding effect</p></dd>
    <dt><code>linrow</code></dt><dd><p>centered row position as a numeric variate (row-8.5)/10</p></dd>
    <dt><code>lincol</code></dt><dd><p>centered column position as a numeric variate (col-3.5)</p></dd>
    <dt><code>linrate</code></dt><dd><p>linear effect of seedrate, scaled (seedrate-41.92958)/10</p></dd>
    <dt><code>yield</code></dt><dd><p>yield in tons/hectare</p></dd>
    <dt><code>year</code></dt><dd><p>year, 1991-1992</p></dd>
    <dt><code>loc</code></dt><dd><p>location</p></dd>
  </dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Nine varieties of lupin were tested for yield response to plant density
  at 11 sites.  The target density in 1991 was 10, 20, ..., 60 plants per
  m^2, and in 1992 was 20, 30, ..., 70 plants per m^2.</p>
<p>Plot dimensions are not given.</p>  
<p>The variety Myallie was grown only in 1992.</p>  
<p>Each site had 2 reps in 1991 and 3 reps in
  1992.  Each rep was laid out as a factorial RCB design; one randomization was
  used for all sites in 1991 and one (different) randomization was used
  for all sites in 1992.  (This was confirmed with the principal
  investigator.)</p>  
<p>In 1991 at the Mt. Barker location, the data for columns
  5 and 6 was discarded due to problems with weeds.</p>  
<p>Variety 'Myallie' was called '84L:439' in Verbyla 1997.</p>  
<p>The year of release for the varieties is</p>  
<p></p><table class='table'>
<tr><td>Unicrop</td><td>1973</td></tr>
<tr><td>Illyarrie</td><td>1979</td></tr>
<tr><td>Yandee</td><td>1980</td></tr>
<tr><td>Danja</td><td>1986</td></tr>
<tr><td>Gungurru</td><td>1988</td></tr>
<tr><td>Yorrel</td><td>1989</td></tr>
<tr><td>Warrah</td><td>1989</td></tr>
<tr><td>Merrit</td><td>1991</td></tr>
<tr><td>Myallie</td><td>1995</td></tr>
</table>


    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Arunas P. Verbyla and Brian R. Cullis and Michael G. Kenward
  and Sue J. Welham, (1999).
  The analysis of designed experiments and longitudinal data by using
  smoothing splines. 
  <em>Appl. Statist.</em>, 48, 269--311.
  http://doi.org/10.1111/1467-9876.00154</p>
<p>Arunas P. Verbyla and Brian R. Cullis and Michael G. Kenward
  and Sue J. Welham, (1997).
  The analysis of designed experiments and longitudinal data by using
  smoothing splines.
  University of Adelaide, Department of Statistics, Research Report
  97/4.
  http://http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.56.808</p>  
<p>Data retrieved Oct 2010 from http://www.blackwellpublishers.co.uk/rss.
  (No longer available).</p>
<p>Used with permission of Blackwell Publishing.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>agridat</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>verbyla.lupin</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>verbyla.lupin</span>

  <span class='co'># The same RCB randomization was used at all sites in each year</span>
  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>desplot</span>)
  <span class='fu'>desplot</span>(<span class='no'>gen</span>~<span class='no'>col</span>+<span class='no'>row</span><span class='kw'>|</span><span class='no'>site</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>,
          <span class='kw'>out1</span><span class='kw'>=</span><span class='no'>rep</span>, <span class='kw'>num</span><span class='kw'>=</span><span class='no'>rate</span>,
          <span class='co'># aspect unknown</span>
          <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"verbyla.lupin - experiment design"</span>)</div><div class='img'><img src='verbyla.lupin-1.png' alt='' width='700' height='433' /></div><div class='input'>

  <span class='co'># Figure 3 of Verbyla</span>
  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>lattice</span>)
  <span class='no'>foo</span> <span class='kw'>&lt;-</span> <span class='fu'>xyplot</span>(<span class='no'>yield</span> ~ <span class='no'>rate</span><span class='kw'>|</span><span class='no'>loc</span>*<span class='no'>gen</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>subset</span><span class='kw'>=</span><span class='no'>year</span><span class='kw'>==</span><span class='fl'>92</span>,
                <span class='kw'>type</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'p'</span>,<span class='st'>'smooth'</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.5</span>,
                <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"verbyla.lupin: 1992 yield response curves"</span>,
                <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Seed rate (plants/m^2)"</span>,
                <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Yield (tons/ha)"</span>,
                <span class='kw'>strip</span><span class='kw'>=</span><span class='fu'>strip.custom</span>(<span class='kw'>par.strip.text</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.7</span>)))

  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>latticeExtra</span>) <span class='co'># for useOuterStrips</span>
  <span class='fu'>useOuterStrips</span>(<span class='no'>foo</span>,
                 <span class='kw'>strip</span><span class='kw'>=</span><span class='fu'>strip.custom</span>(<span class='kw'>par.strip.text</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.7</span>)),
                 <span class='kw'>strip.left</span><span class='kw'>=</span><span class='fu'>strip.custom</span>(<span class='kw'>par.strip.text</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.7</span>)))</div><div class='img'><img src='verbyla.lupin-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># ----------------------------------------------------------------------------</span>

<span class='kw'>if</span>(<span class='fl'>0</span>){

  <span class='co'># We try to reproduce the analysis of Verbyla 1999.</span>
  <span class='co'># May not be exactly the same, but is pretty close.</span>

  <span class='co'># Check nlevels for size of random-coefficient structures</span>
  <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>dat</span>, <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>gen</span>)))      <span class='co'># 9 varieties for RC1</span>
  <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>dat</span>, <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>gen</span>,<span class='no'>site</span>))) <span class='co'># 99 site:gen combinations for RC2</span>

  <span class='co'># Make row and col into factors</span>
  <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat</span>, <span class='kw'>colf</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>col</span>), <span class='kw'>rowf</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>row</span>))
  <span class='co'># sort for asreml</span>
  <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[<span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span>(<span class='no'>dat</span>$<span class='no'>site</span>, <span class='no'>dat</span>$<span class='no'>rowf</span>, <span class='no'>dat</span>$<span class='no'>colf</span>),]

  <span class='co'># Make site names more useful for plots</span>
  <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat</span>, <span class='kw'>site</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='no'>year</span>,<span class='st'>"."</span>,<span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>(<span class='no'>loc</span>,<span class='fl'>1</span>,<span class='fl'>4</span>))))

  <span class='co'># Initial model from top of Verbyla table 9.</span>
<span class='co'>#  libs(asreml4)</span>
  <span class='co'># FIXME asreml4 This is not working in asreml4</span>

<span class='co'>##   m0 &lt;- asreml(yield ~ 1</span>
<span class='co'>##                + site</span>
<span class='co'>##                + linrate</span>
<span class='co'>##                + site:linrate,</span>
<span class='co'>##                data = dat,</span>
<span class='co'>##                random = ~ spl(rate)</span>
<span class='co'>##                + dev(rate)</span>
<span class='co'>##                + site:spl(rate)</span>
<span class='co'>##                + site:dev(rate)</span>
<span class='co'>##                + str(~gen+gen:linrate, ~us(2):id(9)) # RC1</span>
<span class='co'>##                + gen:spl(rate)</span>
<span class='co'>##                + gen:dev(rate)</span>
<span class='co'>##                + str(~site:gen+site:gen:linrate, ~us(2):id(99)) # RC2</span>
<span class='co'>##                + site:gen:spl(rate)</span>
<span class='co'>##                + site:gen:dev(rate),</span>
<span class='co'>##                residual = ~ dsum( ~ ar1(rowf):ar1(colf)|site) # Spatial AR1 x AR1</span>
<span class='co'>##              )</span>
<span class='co'>## m0 &lt;- update(m0)</span>
<span class='co'>## m0 &lt;- update(m0) # to get convergence</span>

<span class='co'>## # Variograms match Verbyla 1999 figure 7 (scale slightly different)</span>
<span class='co'>## plot(varioGram(m0), xlim=c(1:19), zlim=c(0,2),</span>
<span class='co'>##      main="verbyla.lupin - variogram by site")</span>

<span class='co'>##   # Sequence of models in Verbyla 1999 table 10</span>
<span class='co'>## m1 &lt;- update(m0, fixed= ~ .</span>
<span class='co'>##              + at(site, c(2,5,6,8,9,10)):lincol</span>
<span class='co'>##              + at(site, c(3,5,7,8)):linrow</span>
<span class='co'>##              + at(site, c(2,3,5,7,8,9,11)):serp</span>
<span class='co'>##              , random = ~ .</span>
<span class='co'>##              + at(site, c(3,6,7,9)):rowf</span>
<span class='co'>##              + at(site, c(1,2,3,9,10)):colf</span>
<span class='co'>##              + at(site, c(5,7,8,10)):units)</span>
<span class='co'>## m1 &lt;- update(m1)</span>

<span class='co'>## m2 &lt;- update(m1,</span>
<span class='co'>##              random = ~ .</span>
<span class='co'>##              - site:gen:spl(rate) - site:gen:dev(rate))</span>

<span class='co'>## m3 &lt;- update(m2,</span>
<span class='co'>##              random = ~ .</span>
<span class='co'>##              - site:dev(rate) - gen:dev(rate))</span>

<span class='co'>## m4 &lt;- update(m3,</span>
<span class='co'>##              random = ~ .</span>
<span class='co'>##              - dev(rate))</span>

<span class='co'>## m5 &lt;- update(m4,</span>
<span class='co'>##              random = ~ .</span>
<span class='co'>##              - at(site, c(5,7,8,10)):units + at(site, c(5,7,8)):units)</span>

<span class='co'>## # Variance components are a pretty good match to Verbyla 1997, table 15</span>
<span class='co'>## libs(lucid)</span>
<span class='co'>## vc(m5)</span>
<span class='co'>## .001004/sqrt(.005446*.0003662) # .711 correlation for RC1</span>
<span class='co'>## .00175/sqrt(.01881*.000167) # .987 correlation for RC2</span>

<span class='co'>## # Matches Verbyla 1999 figure 5</span>
<span class='co'>## plot(varioGram(m5),</span>
<span class='co'>##      main="verbyla.lupin - final model variograms",</span>
<span class='co'>##      xlim=c(1:19), zlim=c(0,1.5))</span>

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#source">Source</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


