<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Height of barley plants in a study of non-normal data — eden.nonnormal • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Height of barley plants in a study of non-normal data — eden.nonnormal" />
<meta property="og:description" content="Height of barley plants in a study of non-normal data." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_intro.html">Introduction to `agridat`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Height of barley plants in a study of non-normal data</h1>
    
    <div class="hidden name"><code>eden.nonnormal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Height of barley plants in a study of non-normal data.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"eden.nonnormal"</span>)</pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>A data frame with 256 observations on the following 3 variables.</p><dl'>
    <dt><code>pos</code></dt><dd><p>position within block</p></dd>
    <dt><code>block</code></dt><dd><p>block (numeric)</p></dd>
    <dt><code>height</code></dt><dd><p>height of wheat plant</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>This data was used in a very early example of a permutation test.</p>  
<p>Eden &amp; Yates used this data to consider the impact of non-normal data
  on the validitiy of a hypothesis test that assumes normality.  They
  concluded that the skew data did not negatively affect the analysis of
  variance.</p>
<p>Grown at Rothamsted. Eight blocks of Yeoman II wheat.  Sampling of the
  blocks was quarter-meter rows, four times in each row.  Rows were
  selected at random. Position  within the rows was partly controlled to
  make use of the whole length of the block.  Plants at both ends of the
  sub-unit were measured. Shoot height is measured from ground level to
  the auricle of the last expanded leaf.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>T. Eden, F. Yates (1933).
  On the validity of Fisher's z test when applied to an actual example of non-normal data.
  <em>Journal of Agric Science</em>, 23, 6-17.
  https://doi.org/10.1017/S0021859600052862</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kenneth J. Berry, Paul W. Mielke, Jr., Janis E. Johnston
  <em>Permutation Statistical Methods: An Integrated Approach</em>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>agridat</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>eden.nonnormal</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>eden.nonnormal</span>
<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>dat</span>$<span class='no'>height</span>) <span class='co'># 55.23 matches Eden table 1</span></div><div class='output co'>#&gt; [1] 55.23242</div><div class='input'>
<span class='co'># Eden figure 2</span>
<span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>dplyr</span>, <span class='no'>lattice</span>)
<span class='co'># Blocks had different means, so substract block mean from each datum</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>group_by</span>(<span class='no'>dat</span>, <span class='no'>block</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>mutate</span>(<span class='no'>dat</span>, <span class='kw'>blkmn</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>height</span>))
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat</span>, <span class='kw'>dev</span><span class='kw'>=</span><span class='no'>height</span>-<span class='no'>blkmn</span>)

<span class='fu'>histogram</span>( ~ <span class='no'>dev</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>from</span><span class='kw'>=</span>-<span class='fl'>40</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>by</span><span class='kw'>=</span><span class='fl'>2.5</span>),
          <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Deviations from block means"</span>,
          <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"eden.nonnormal - heights skewed left"</span>)</div><div class='img'><img src='eden.nonnormal-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># \dontrun{</span>

  <span class='co'># calculate skewness, permutation </span>

  <span class='fu'><a href='libs.html'>libs</a></span>(<span class='no'>dplyr</span>, <span class='no'>lattice</span>, <span class='no'>latticeExtra</span>)

  <span class='co'># Eden table 1</span>
  <span class='co'># anova(aov(height ~ factor(block), data=dat))</span>

  <span class='co'># Eden table 2,3. Note, this may be a different definition of skewness</span>
  <span class='co'># than is commonly used today (e.g. e1071::skewness).</span>
  <span class='no'>skew</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>){
    <span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>x</span>)
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> - <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>x</span>)
    <span class='no'>s1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x</span>)
    <span class='no'>s2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x</span>^<span class='fl'>2</span>)
    <span class='no'>s3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x</span>^<span class='fl'>3</span>)
    <span class='no'>k3</span><span class='kw'>=</span><span class='no'>n</span>/((<span class='no'>n</span>-<span class='fl'>1</span>)*(<span class='no'>n</span>-<span class='fl'>2</span>)) * <span class='no'>s3</span> -<span class='fl'>3</span>/<span class='no'>n</span>*<span class='no'>s2</span>*<span class='no'>s1</span> + <span class='fl'>2</span>/<span class='no'>n</span>^<span class='fl'>2</span> * <span class='no'>s1</span>^<span class='fl'>3</span>
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>k3</span>)
  }
  <span class='co'># Negative values indicate data are skewed left</span>
  <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>group_by</span>(<span class='no'>dat</span>, <span class='no'>block</span>)
  <span class='fu'>summarize</span>(<span class='no'>dat</span>, <span class='kw'>s1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>height</span>),<span class='kw'>s2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>height</span>^<span class='fl'>2</span>), <span class='kw'>mean2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span>(<span class='no'>height</span>), <span class='kw'>k3</span><span class='kw'>=</span><span class='fu'>skew</span>(<span class='no'>height</span>))</div><div class='output co'>#&gt; <span class='message'>`summarise()` ungrouping output (override with `.groups` argument)</span></div><div class='output co'>#&gt; # A tibble: 8 x 5
#&gt;   block    s1      s2 mean2     k3
#&gt;   &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1     1 1682   95930. 243.  -1269.
#&gt; 2     2 1858  111662. 122.  -1752.
#&gt; 3     3 1810. 108967. 214.  -3173.
#&gt; 4     4 1912  121748. 242.  -2548.
#&gt; 5     5 1722   99026. 205.   -559.
#&gt; 6     6 1339   63077  227.   -801.
#&gt; 7     7 1963  123052.  85.0  -713.
#&gt; 8     8 1854  112366  160.  -1062.</div><div class='input'>  <span class='co'>##   block     s1       s2     mean2         k3</span>
  <span class='co'>##   &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span>
  <span class='co'>## 1     1 1682.0  95929.5 242.56048 -1268.5210</span>
  <span class='co'>## 2     2 1858.0 111661.5 121.97984 -1751.9919</span>
  <span class='co'>## 3     3 1809.5 108966.8 214.36064 -3172.5284</span>
  <span class='co'>## 4     4 1912.0 121748.5 242.14516 -2548.2194</span>
  <span class='co'>## 5     5 1722.0  99026.5 205.20565  -559.0629</span>
  <span class='co'>## 6     6 1339.0  63077.0 227.36190  -801.2740</span>
  <span class='co'>## 7     7 1963.0 123052.5  84.99093  -713.2595</span>
  <span class='co'>## 8     8 1854.0 112366.0 159.67339 -1061.9919</span>

  <span class='co'># Another way to view skewness with qq plot. Panel 3 most skewed.</span>
  <span class='fu'>qqmath</span>( ~ <span class='no'>dev</span><span class='kw'>|</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>block</span>), <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>,
         <span class='kw'>as.table</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
         <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Deviations from block means"</span>,
         <span class='kw'>panel</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>...</span>) {
           <span class='fu'>panel.qqmathline</span>(<span class='no'>x</span>, <span class='no'>...</span>)
           <span class='fu'>panel.qqmath</span>(<span class='no'>x</span>, <span class='no'>...</span>)
         })</div><div class='img'><img src='eden.nonnormal-2.png' alt='' width='700' height='433' /></div><div class='input'>
  <span class='co'># Now, permutation test.</span>
  <span class='co'># Eden: "By a process of amalgamation the eight sets of 32 observations were</span>
  <span class='co'># reduced to eight sets of four and the data treated as a potential</span>
  <span class='co'># layout for a 32-plot trial".</span>
  <span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>dat</span>, <span class='kw'>grp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>4</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>8</span>))
  <span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span>(<span class='no'>height</span> ~ <span class='no'>grp</span>+<span class='no'>block</span>, <span class='no'>dat2</span>, <span class='no'>sum</span>)
  <span class='no'>dat2</span>$<span class='no'>trt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>4</span>], <span class='fl'>8</span>)
  <span class='no'>dat2</span>$<span class='no'>block</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>dat2</span>$<span class='no'>block</span>)

  <span class='co'># Treatments were assigned at random 1000 times</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>54323</span>)
  <span class='no'>fobs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>NA</span>, <span class='fl'>1000</span>)
  <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>1000</span>){
    <span class='co'># randomize treatments within each block</span>
    <span class='co'># trick from http://stackoverflow.com/questions/25085537</span>
    <span class='no'>dat2</span>$<span class='no'>trt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>dat2</span>, <span class='fu'><a href='https://rdrr.io/r/stats/ave.html'>ave</a></span>(<span class='no'>trt</span>, <span class='no'>block</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>sample</span>))
    <span class='no'>fobs</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span>(<span class='no'>height</span> ~ <span class='no'>block</span> + <span class='no'>trt</span>, <span class='no'>dat2</span>))[<span class='st'>"trt"</span>,<span class='st'>"F value"</span>]
  }

  <span class='co'># F distribution with 3,21 deg freedom</span>
  <span class='co'># Similar to Eden's figure 4, but on a different horizontal scale</span>
  <span class='no'>xval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>to</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>fobs</span>), <span class='kw'>length</span><span class='kw'>=</span><span class='fl'>50</span>)
  <span class='no'>yval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>df</a></span>(<span class='no'>xval</span>, <span class='kw'>df1</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>df2</span> <span class='kw'>=</span> <span class='fl'>21</span>)
  <span class='co'># Re-scale, 10 = max of historgram, 0.7 = max of density</span>
  <span class='fu'>histogram</span>( ~ <span class='no'>fobs</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='no'>xval</span>,
            <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"F value"</span>,
            <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Observed (histogram) &amp; theoretical (line) F values"</span>) +
    <span class='fu'>xyplot</span>((<span class='fl'>10</span>/<span class='fl'>.7</span>)* <span class='no'>yval</span> ~ <span class='no'>xval</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='eden.nonnormal-3.png' alt='' width='700' height='433' /></div><div class='input'>
# }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


